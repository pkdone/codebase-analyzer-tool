<%- include('section-header', { title: 'Current Architecture', jsonFile: 'inferred-architecture.json', jsonIconSvg: jsonIconSvg }) %>

<div class="note-box">
  <p><strong>Note:</strong> This diagram shows the high-level business components inferred from the existing codebase. Internal components (green) represent core business functionality, while external dependencies (orange) represent external systems such as databases, message queues, and external APIs.</p>
</div>

<div class="diagram-container">
  <h3>Architecture Overview</h3>
  
  <div class="architecture-diagram-svg">
    <%- currentArchitectureDiagramSvg %>
  </div>
</div>

<% if (inferredArchitectureData) { %>
  <% if (inferredArchitectureData.internalComponents && inferredArchitectureData.internalComponents.length > 0) { %>
    <div class="architecture-details">
      <h3>Internal Business Components</h3>
      
      <% inferredArchitectureData.internalComponents.forEach(component => { %>
        <div class="component-detail">
          <h4><%= component.name %></h4>
          <p><%= component.description %></p>
        </div>
      <% }); %>
    </div>
  <% } %>
  
  <% if (inferredArchitectureData.externalDependencies && inferredArchitectureData.externalDependencies.length > 0) { %>
    <div class="architecture-details">
      <h3>External Dependencies</h3>
      
      <table class="data-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <% inferredArchitectureData.externalDependencies.forEach(dep => { %>
            <tr>
              <td><strong><%= dep.name %></strong></td>
              <td><span class="badge"><%= dep.type %></span></td>
              <td><%= dep.description %></td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  <% } %>
<% } %>


